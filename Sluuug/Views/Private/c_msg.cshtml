
@{
    ViewBag.Title = "c_msg";
    Layout = "~/Views/Shared/private_template.cshtml";
}
@using Slug.Extensions
<link href="~/Styles/private/search-result-style.css" rel="stylesheet" />
<link href="~/Styles/private/secret-dialog-style.css" rel="stylesheet" />

<title>Зашифрованный диалог</title>
<div class="active-chat-period">
    <p>
        <span>
            Осталось : <span class="experation-mins">59</span> мин
            <span class="experation-sec">33</span> сек
        </span>
    </p>
</div>
<div class="result-pagination stylized-scrollbar">
    @for (int i = 1; i <= Model.PagesCount; i++)
    {
        <div class="search-link-container">
            <a href="@Url.Action("c_msg","private", new { id=Model.GuidId, page=i })">@i</a>
        </div>
    }
</div>

<div class="dialog stylized-scrollbar">
    @foreach (var msg in Model.Messages)
    {
        if (msg.IsIncomming)
        {
            <div class="dialog-msg-wrapper-in">
                <div class="in-content-secret">
                    <img class="lock-msg-img" src="https://res.cloudinary.com/dlk1sqmj4/image/upload/c_scale,h_25,w_25/v1562229078/lock-msg.png">
                    <img src="@msg.AvatatURI" />
                    <a>@msg.Name</a>
                    <span>@msg.SendDate.ToString("hh:mm")</span>
                    <span class="crypt-message">@msg.Text</span>
                    <div class="triangle_wrapper_in"><div class="triangle_container"><div class="triangle"></div></div></div>
                </div>
            </div>
        }
        else
        {
            <div class="dialog-msg-wrapper-out">
                <div class="out-content-secret">
                    <img class="lock-msg-img" src="https://res.cloudinary.com/dlk1sqmj4/image/upload/c_scale,h_25,w_25/v1562229078/lock-msg.png">
                    <img src="@msg.AvatatURI" />
                    <a>@msg.Name</a>
                    <span>@msg.SendDate.ToString("hh:mm")</span>
                    <span class="crypt-message">@msg.Text</span>
                    <div class="triangle_wrapper_out"><div class="triangle_container"><div class="triangle"></div></div></div>
                </div>
            </div>
        }

    }
</div>

<div class="send_msg" style="margin-top:33px">
    <textarea id="new_text"></textarea>
        <button id="sendButton" onclick="crypt_send()">@Html.Translate("Button_Send_Message")</button>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
<script src="~/Scripts/crypto_dialog.js"></script>
<script src="~/Scripts/Private/ExperationTimer.js"></script>
<script>

    $(document).ready(function () {
        var objDiv = $(".dialog")[0];
        objDiv.scrollTop = objDiv.scrollHeight;
    });

</script>