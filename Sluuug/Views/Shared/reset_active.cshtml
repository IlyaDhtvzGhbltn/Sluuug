    <form class="form" style="margin-top:10px;">
    <h2>Смена пароля</h2>

    <p>Придумайте новый пароль</p>
    <div class="field-wrap">
        <input type="password" id="new_pass" placeholder="Новый пароль" oninput="validate()" required autocomplete="off" />
    </div>
    <p>Повторите пароль</p>
    <div class="field-wrap">
        <input type="password" id="new_pass_again" placeholder="Новый пароль еще раз" oninput="validate()" required autocomplete="off" />
    </div>
    <div class="field-wrap">
        <input type="button" id="reset_subm" class="button button-block" disabled onclick="completeReset()" value="Сменить пароль" />
    </div>
    <div class="error-message-form" style="color:red" id="notMatch">Пароли не совпадают</div>
    <div class="error-message-form" style="color:green" id="match">Пароли совпадают!</div>
    <div class="error-message-form" style="color:red" id="toSlow">Новый пароль слишком короткий (мин 8 символов)</div>
    <div class="error-message-form" style="color:green" id="strong">Введенный пароль надежен!</div>
    <div class="error-message-form" style="color:red" id="fail">Не удалось установить пароль</div>
    <div class="error-message-form" style="color:green" id="success">Новый пароль установлен! Что бы войти нажмите <a href="./#reg_log">здесь.</a></div>

    <div id="circular3dG" hidden>
        <div id="circular3d_1G" class="circular3dG"></div>
        <div id="circular3d_2G" class="circular3dG"></div>
        <div id="circular3d_3G" class="circular3dG"></div>
        <div id="circular3d_4G" class="circular3dG"></div>
        <div id="circular3d_5G" class="circular3dG"></div>
        <div id="circular3d_6G" class="circular3dG"></div>
        <div id="circular3d_7G" class="circular3dG"></div>
        <div id="circular3d_8G" class="circular3dG"></div>
    </div>
</form>
<script>
    function validate() {
        $('#fail').fadeOut();
        $('#success').fadeOut();

        var compareFlag = compare();
        if (compareFlag) {

            $('#notMatch').fadeOut();
            $('#match').fadeIn();
            var strongFlag = checkLength();
            if (strongFlag) {
                $('#toSlow').fadeOut();
                $('#strong').fadeIn();
                $('#reset_subm').attr("disabled", false);
            }
            else {
                $('#notMatch').fadeOut();
                $('#toSlow').fadeIn();
                $('#reset_subm').attr("disabled", true);
            }
        }
        else {
            $('#strong').fadeOut();
            $('#notMatch').fadeIn();
            $('#match').fadeOut();
            $('#reset_subm').attr("disabled", true);
        }
    }
    function compare() {
        let newHash = $('#new_pass').val();
        let newHashAgain = $('#new_pass_again').val();
        if (newHash == newHashAgain) {
            return true;
        }
        return false;
    }
    function checkLength() {
        let len = $('#new_pass').val();
        if (len.length >= 8) {
            return true;
        }
        return false;
    }

    function completeReset() {
        $('#circular3dG')[0].style.display = "block";
        $('#reset_subm').attr("disabled", true);

        let newPass = $('#new_pass').val();
        var hash = getSHA(newPass);

        var url_string = window.location.href
        var url = new URL(url_string);
        var param = url.searchParams.get("reset_param");

        $.ajax({
            url: '/public_api/reset_password_confirm',
            method: 'post',
            data: { passHash: hash, reset_param: param },
            success: function (resp) {
                console.log(resp);
                $('#reset_subm').attr("disabled", false);
                $('#circular3dG').fadeOut();

                if (resp) {
                    $('#fail').fadeOut();
                    $('#success').fadeIn();
                }
                else {
                    $('#success').fadeOut();
                    $('#fail').fadeIn();
                }
            }
        });
    }
</script>